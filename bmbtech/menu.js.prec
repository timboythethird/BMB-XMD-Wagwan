const { zokou } = require(__dirname + "/../framework/zokou");
const { format, styletext } = require(__dirname + "/../framework/mesfonctions");
const os = require('os');
const moment = require("moment-timezone");
const s = require(__dirname + '/../set');

zokou({
  nomCom: "menu6",
  categorie: "General"
}, async (dest, zk, commandeOptions) => {
  const { ms, repondre } = commandeOptions;
  const { cm } = require(__dirname + "/../framework/zokou");

  let commandCategories = {};
  let mode = s.MODE.toLowerCase() !== 'oui' ? 'privÃ©' : 'public';

  const emojis = {
    'General': 'ğŸŒ',
    'Logo': 'ğŸ¨',
    'Hentai': 'ğŸ”¥',
    'Weeb': 'ğŸŒ¸',
    'Recherche': 'ğŸ”',
    'Conversion': 'ğŸŒŸ',
    'Groupe': 'â™»ï¸',
    'Autre': 'ğŸª–'
  };

  cm.map((cmd) => {
    if (!commandCategories[cmd.categorie]) {
      commandCategories[cmd.categorie] = [];
    }
    commandCategories[cmd.categorie].push(cmd.nomCom);
  });

  moment.tz.setDefault("Asia/Karachi").locale('fr');
  const currentTime = moment().format("HH:mm:ss");
  const currentDate = moment().format("DD/MM/YYYY");

  let menuText = "â•©â•â•â• * Æµğ“ï½‹Ã˜ğ“Š * â•©â•â•â•\n\n";
  menuText += `â•”â•â•â•â•---------\n
â•‘    PrÃ©fixe : ${s.PREFIXE}
â•‘    Owner : ${s.OWNER_NAME}
â•‘    Mode : ${mode}
â•‘    Commandes: ${cm.length}
â•‘    Date : ${currentDate}
â•‘    Heure : ${currentTime}
â•‘    MÃ©moire : ${format(os.totalmem() - os.freemem())}/${format(os.totalmem())}
â•‘    Plateforme : ${os.platform()}
â•‘    DÃ©veloppeurs : Djalega++ || Luffy
â•šâ•â•â•â•---------------\n\n`;

  for (const categorie in commandCategories) {
    const icon = emojis[categorie] || 'ğŸ’';
    menuText += `${icon} â•â• *${categorie}* â•â• ${icon}\n`;
    commandCategories[categorie].forEach(cmd => {
      menuText += `\t  â•‘ ${cmd}\n`;
    });
  }

  try {
    await zk.sendMessage(dest, {
      image: { url: s.IMAGE_MENU },
      caption: menuText,
      footer: "by Djalega++"
    }, { quoted: ms });
  } catch (err) {
    console.error("ğŸ¥µğŸ¥µ Menu erreur", err);
    repondre("ğŸ¥µğŸ¥µ Menu erreur " + err);
  }
});
